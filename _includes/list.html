<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* 样式定义 */
    .container {
      display: flex;
      flex-wrap: wrap;
    }

    .item {
      flex: 1 1 30%; /* 每行三个元素，每个元素约占30%的宽度 */
      box-sizing: border-box;
      margin-right: 2%; /* 控制元素之间的水平间距 */
      margin-bottom: 20px; /* 控制元素之间的垂直间距 */
    }

    /* 处理每行最后一个元素不需要右侧间距的情况 */
    .item:nth-child(3n) {
      margin-right: 0; /* 去掉每行最后一个元素的右侧间距 */
    }
  </style>
</head>
<body>

<div class="container">
  {%- assign emptyarray = "" | split: "," -%}
  {%- assign data = site.data[include.data] | default: site[include.data] | default: emptyarray -%}
  {%- assign component = include.component | append: ".html" -%}

  {%- assign filters = include.filters | split: "," -%}
  {%- for filter in filters -%}
    {%- assign entry = filter | split: ":" -%}
    {%- assign key = entry[0] | strip -%}
    {%- assign value = entry[1] | strip | default: nil -%}
    {%- if value contains "~" -%}
      {%- assign value = value | remove: "~" -%}
      {%- assign data = data | where_exp: "d", "d[key] contains value" -%}
    {%- else -%}
      {%- assign tonumber = value | plus: 0 -%}
      {%- capture numbertostring -%}{{- tonumber -}}{%- endcapture -%}
      {%- if value == numbertostring -%}
        {%- assign value = tonumber -%}
      {%- endif -%}
      {%- assign data = data | where_exp: "d", "d[key] == value" -%}
    {%- endif -%}
  {%- endfor -%}

  {%- assign years = data | group_by_exp: "d", "d.date | date: '%Y'" | sort: "name" | reverse -%}

  {%- for year in years -%}

  {%- assign items = year.items -%}

  {%- if years.size > 1 -%}
    <h3 id="{{ year.name }}">{{ year.name }}</h3>
    {%- assign items = items | sort: "date" | reverse -%}
  {%- endif -%}

  {%- for d in items -%}

    {%- assign link = d.link | default: d.url -%}
    {%- assign style = d.style | default: include.style -%}
    
    <div class="item">
      
      {% include {{ component }}
        author=d.author
        caption=d.caption
        content=d.content
        date=d.date
        description=d.description
        extra-links=d.extra-links
        headline=d.headline
        height=d.height
        icon=d.icon
        id=d.id
        image=d.image
        link=link
        name=d.name
        repo=d.repo
        role=d.role
        slug=d.slug
        style=style
        tags=d.tags
        title=d.title
        text=d.text
        tooltip=d.tooltip
        type=d.type
        url=d.url
        width=d.width
      %}
    </div>

  {%- endfor -%}

  {%- endfor -%}
</div>

</body>

